{"version":3,"sources":["../src/DefaultClock.js"],"names":["DefaultClock","registeredCallbacks","Map","count","animationFrame","requestAnimationFrame","forEach","callback","size","tickIfNecessary","cancelAnimationFrame","id","set","delete","stopIfNecessary","performance","now"],"mappings":";;;;;;;;;;;;;IAAqBA,Y;;;AACnB,0BAAc;AAAA;;AACZ,SAAKC,mBAAL,GAA2B,IAAIC,GAAJ,EAA3B;AACA,SAAKC,KAAL,GAAa,CAAb;AACA,SAAKC,cAAL,GAAsB,IAAtB;AACD;;;;sCAEiB;AAAA;;AAChB,UAAI,KAAKA,cAAL,IAAuB,IAA3B,EAAiC;AAC/B,aAAKA,cAAL,GAAsB,IAAtB;AAEA,aAAKA,cAAL,GAAsB,KAAKC,qBAAL,CAA2B,YAAM;AACrD,UAAA,KAAI,CAACJ,mBAAL,CAAyBK,OAAzB,CAAiC,UAAAC,QAAQ,EAAI;AAC3CA,YAAAA,QAAQ;AACT,WAFD;;AAGA,cAAI,KAAI,CAACN,mBAAL,CAAyBO,IAAzB,GAAgC,CAApC,EAAuC;AACrC,YAAA,KAAI,CAACC,eAAL;AACD;AACF,SAPqB,CAAtB;AAQD;AACF;;;sCAEiB;AAChB,UAAI,KAAKR,mBAAL,CAAyBO,IAAzB,IAAiC,CAArC,EAAuC;AACrCE,QAAAA,oBAAoB,CAAC,KAAKN,cAAN,CAApB;AACA,aAAKA,cAAL,GAAsB,IAAtB;AACD;AACF;;;0CAEqBG,Q,EAAU;AAC9B,UAAMI,EAAE,GAAGR,KAAK,EAAhB;AACA,WAAKF,mBAAL,CAAyBW,GAAzB,CAA6BD,EAA7B,EAAiCJ,QAAjC;AACA,WAAKE,eAAL;AACA,aAAOE,EAAP;AACD;;;yCAEoBA,E,EAAI;AACvB,WAAKV,mBAAL,CAAyBY,MAAzB,CAAgCF,EAAhC;AACA,WAAKG,eAAL;AACD;;;0BAEK;AACJ,aAAOC,WAAW,CAACC,GAAZ,EAAP;AACD","sourcesContent":["export default class DefaultClock {\n  constructor() {\n    this.registeredCallbacks = new Map();\n    this.count = 1;\n    this.animationFrame = null;\n  }\n\n  tickIfNecessary() {\n    if (this.animationFrame == null) {\n      this.animationFrame = null;\n\n      this.animationFrame = this.requestAnimationFrame(() => {\n        this.registeredCallbacks.forEach(callback => {\n          callback();\n        });\n        if (this.registeredCallbacks.size > 0) {\n          this.tickIfNecessary();\n        }\n      });\n    }\n  }\n\n  stopIfNecessary() {\n    if (this.registeredCallbacks.size <= 0){\n      cancelAnimationFrame(this.animationFrame);\n      this.animationFrame = null;\n    }\n  }\n\n  requestAnimationFrame(callback) {\n    const id = count++;\n    this.registeredCallbacks.set(id, callback);\n    this.tickIfNecessary();\n    return id;\n  }\n\n  cancelAnimationFrame(id) {\n    this.registeredCallbacks.delete(id);\n    this.stopIfNecessary();\n  }\n\n  now() {\n    return performance.now();\n  }\n}\n"],"file":"DefaultClock.js"}